# æ•°æ®åº“è¿ç§»è¯´æ˜æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°å°†å‰ç«¯çš„ `localStorage` å­˜å‚¨æ–¹å¼è¿ç§»åˆ°åç«¯æ•°æ®åº“å­˜å‚¨ï¼Œå®ç°äº†çœŸæ­£çš„æ•°æ®æŒä¹…åŒ–å’Œå¤šç”¨æˆ·æ•°æ®éš”ç¦»ã€‚

## ä¸ºä»€ä¹ˆè¦è¿ç§»ï¼Ÿ

æ‚¨æå‡ºçš„é—®é¢˜ï¼š"ä¸ºä»€ä¹ˆä¸ç›´æ¥æŠŠ `frontend/src/store/modules` é‡Œçš„ JS å­˜å‚¨æ¢æˆæ•°æ®åº“å­˜å‚¨ï¼Ÿ"

**å›ç­”ï¼šè¿™æ­£æ˜¯æˆ‘ä»¬åšçš„äº‹æƒ…ï¼ä½†éœ€è¦ä»¥ä¸‹å¿…è¦æ­¥éª¤ï¼š**

### åŸæ¥çš„å­˜å‚¨æ–¹å¼ï¼ˆlocalStorageï¼‰
```javascript
// src/store/modules/network.js
addNode(node) {
  this.nodes.push(node)  // ç›´æ¥æ“ä½œå†…å­˜æ•°ç»„
}
```

### æ”¹é€ åçš„å­˜å‚¨æ–¹å¼ï¼ˆæ•°æ®åº“ï¼‰
```javascript
// æ”¹é€ åéœ€è¦è°ƒç”¨åç«¯ API
async addNode(node) {
  const response = await axios.post('/api/projects/nodes', node)
  this.nodes.push(response.data.node)
}
```

### ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›æ­¥éª¤ï¼Ÿ

| æ­¥éª¤ | å¿…è¦æ€§ | è¯´æ˜ |
|---|---|---|
| 1. åˆ›å»ºæ•°æ®åº“æ¨¡å‹ | **å¿…é¡»** | å®šä¹‰æ•°æ®ç»“æ„ï¼ˆé¡¹ç›®ã€èŠ‚ç‚¹ã€è¾¹ç­‰ï¼‰ |
| 2. åˆ›å»ºåç«¯ API | **å¿…é¡»** | æä¾›æ•°æ®æ“ä½œæ¥å£ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰ |
| 3. ä¿®æ”¹å‰ç«¯è°ƒç”¨ | **å¿…é¡»** | ä»åŒæ­¥æ“ä½œæ”¹ä¸ºå¼‚æ­¥ API è°ƒç”¨ |
| 4. æ•°æ®åº“ç®¡ç†å·¥å…· | **æ¨è** | ç¡®ä¿æµ‹è¯•æ—¶æ•°æ®åº“ç¨³å®šæ€§ |

## æ¶æ„å˜åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åŸæ¥çš„æ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ Pinia Store  â”€â”€â†’  localStorageï¼ˆæµè§ˆå™¨æœ¬åœ°ï¼‰        â”‚
â”‚  - æ•°æ®åªåœ¨æœ¬åœ°                                           â”‚
â”‚  - æ¸…é™¤ç¼“å­˜å°±ä¸¢å¤±                                         â”‚
â”‚  - æ— æ³•å¤šè®¾å¤‡åŒæ­¥                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ–°çš„æ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ Pinia Store  â”€â”€â†’  åç«¯ API  â”€â”€â†’  SQLite æ•°æ®åº“      â”‚
â”‚  - æ•°æ®æ°¸ä¹…ä¿å­˜                                           â”‚
â”‚  - æ”¯æŒå¤šç”¨æˆ·                                             â”‚
â”‚  - å¯å¤‡ä»½æ¢å¤                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–‡ä»¶å˜åŒ–æ¸…å•

### åç«¯æ–°å¢æ–‡ä»¶

```
backend/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ Project_model.js           # é¡¹ç›®æ¨¡å‹ï¼ˆå­˜å‚¨ç½‘ç»œèŠ‚ç‚¹å’Œè¾¹ï¼‰
â”‚   â””â”€â”€ EvaluationHistory_model.js # è¯„ä¼°å†å²æ¨¡å‹
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ projects.js                # é¡¹ç›® CRUD API
â”‚   â””â”€â”€ evaluations.js             # è¯„ä¼°å†å² CRUD API
â””â”€â”€ scripts/
    â””â”€â”€ dbManager.js               # æ•°æ®åº“ç®¡ç†å·¥å…·
```

### å‰ç«¯ä¿®æ”¹æ–‡ä»¶

```
src/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ network.js                 # æ›´æ–° API è°ƒç”¨è·¯å¾„
â””â”€â”€ vite.config.js                 # æ›´æ–°ä»£ç†é…ç½®
```

### é…ç½®æ–‡ä»¶

```
.gitignore                         # å¿½ç•¥æ•°æ®åº“æ–‡ä»¶å’Œå¤‡ä»½
```

## æ•°æ®åº“ç®¡ç†å·¥å…·ä½¿ç”¨

ä¸ºäº†ç¡®ä¿æµ‹è¯•è¿‡ç¨‹ä¸­çš„æ•°æ®åº“ç¨³å®šæ€§ï¼Œæˆ‘ä»¬æä¾›äº†å®Œæ•´çš„æ•°æ®åº“ç®¡ç†å·¥å…·ã€‚

### åŸºç¡€å‘½ä»¤

```bash
cd backend

# åˆå§‹åŒ–æ•°æ®åº“ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
node scripts/dbManager.js init

# æŸ¥çœ‹æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
node scripts/dbManager.js stats

# åˆ›å»ºæµ‹è¯•æ•°æ®
node scripts/dbManager.js test-data

# æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆä¿ç•™è¡¨ç»“æ„ï¼‰
node scripts/dbManager.js clear

# å®Œå…¨é‡ç½®æ•°æ®åº“ï¼ˆåˆ é™¤å¹¶é‡å»ºè¡¨ï¼‰
node scripts/dbManager.js reset

# å¤‡ä»½æ•°æ®åº“
node scripts/dbManager.js backup

# æ¢å¤æ•°æ®åº“ï¼ˆä»æœ€æ–°å¤‡ä»½ï¼‰
node scripts/dbManager.js restore

# æ¢å¤æ•°æ®åº“ï¼ˆä»æŒ‡å®šå¤‡ä»½ï¼‰
node scripts/dbManager.js restore /path/to/backup.sqlite

# æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘5ä¸ªï¼‰
node scripts/dbManager.js clean-backups
node scripts/dbManager.js clean-backups 10  # ä¿ç•™æœ€è¿‘10ä¸ª
```

### å…¸å‹ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šæµ‹è¯•å‰æ¸…ç©ºæ•°æ®
```bash
# å…ˆå¤‡ä»½å½“å‰æ•°æ®
node scripts/dbManager.js backup

# æ¸…ç©ºæ‰€æœ‰æ•°æ®
node scripts/dbManager.js clear

# åˆ›å»ºå¹²å‡€çš„æµ‹è¯•æ•°æ®
node scripts/dbManager.js test-data
```

#### åœºæ™¯2ï¼šæµ‹è¯•å¤±è´¥åæ¢å¤
```bash
# æ¢å¤åˆ°æœ€è¿‘çš„å¤‡ä»½
node scripts/dbManager.js restore
```

#### åœºæ™¯3ï¼šå®šæœŸç»´æŠ¤
```bash
# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
node scripts/dbManager.js stats

# æ¸…ç†æ—§å¤‡ä»½
node scripts/dbManager.js clean-backups 5
```

## API æ¥å£æ–‡æ¡£

### é¡¹ç›®ç®¡ç† API

#### è·å–é¡¹ç›®åˆ—è¡¨
```http
GET /api/projects
Query: status, limit, offset
```

#### è·å–é¡¹ç›®è¯¦æƒ…
```http
GET /api/projects/:id
```

#### åˆ›å»ºé¡¹ç›®
```http
POST /api/projects
Body: {
  name: string,
  description: string,
  nodes: array,
  edges: array,
  network_mode: string
}
```

#### æ›´æ–°é¡¹ç›®
```http
PUT /api/projects/:id
Body: {
  name, description, nodes, edges, status, network_mode
}
```

#### åˆ é™¤é¡¹ç›®
```http
DELETE /api/projects/:id
```

#### æ·»åŠ èŠ‚ç‚¹
```http
POST /api/projects/:id/nodes
Body: { node: {...} }
```

#### æ›´æ–°èŠ‚ç‚¹
```http
PUT /api/projects/:id/nodes/:nodeId
Body: { updates: {...} }
```

#### åˆ é™¤èŠ‚ç‚¹
```http
DELETE /api/projects/:id/nodes/:nodeId
```

#### æ·»åŠ è¾¹
```http
POST /api/projects/:id/edges
Body: { edge: {...} }
```

#### åˆ é™¤è¾¹
```http
DELETE /api/projects/:id/edges/:edgeId
```

### è¯„ä¼°å†å² API

#### è·å–è¯„ä¼°å†å²åˆ—è¡¨
```http
GET /api/evaluations
Query: project_id, limit, offset
```

#### åˆ›å»ºè¯„ä¼°è®°å½•
```http
POST /api/evaluations
Body: {
  project_id: number,
  project_name: string,
  overall_score: number,
  metrics: object,
  vulnerabilities: array,
  suggestions: array
}
```

#### è·å–é¡¹ç›®çš„è¯„ä¼°å†å²
```http
GET /api/evaluations/project/:projectId
```

#### è·å–è¯„ä¼°ç»Ÿè®¡
```http
GET /api/evaluations/stats/overview
```

## å¯åŠ¨å’Œæµ‹è¯•

### 1. å¯åŠ¨åç«¯æœåŠ¡å™¨

```bash
cd backend
npm install  # å¦‚æœè¿˜æ²¡å®‰è£…ä¾èµ–
node server.js
```

é¢„æœŸè¾“å‡ºï¼š
```
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ
âœ… æ•°æ®åº“æ¨¡å‹åŒæ­¥å®Œæˆ
ğŸš€ æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000
ğŸ“Š å¥åº·æ£€æŸ¥: http://localhost:3000/health
ğŸ“š APIåŸºç¡€è·¯å¾„: http://localhost:3000/api
```

### 2. æµ‹è¯•åç«¯ API

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3000/health

# è·å–é¡¹ç›®åˆ—è¡¨ï¼ˆåº”è¯¥ä¸ºç©ºï¼‰
curl http://localhost:3000/api/projects

# åˆ›å»ºæµ‹è¯•æ•°æ®
cd backend
node scripts/dbManager.js test-data

# å†æ¬¡è·å–é¡¹ç›®åˆ—è¡¨ï¼ˆåº”è¯¥æœ‰æ•°æ®ï¼‰
curl http://localhost:3000/api/projects
```

### 3. å¯åŠ¨å‰ç«¯æœåŠ¡å™¨

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
npm install  # å¦‚æœè¿˜æ²¡å®‰è£…ä¾èµ–
npm run dev
```

å‰ç«¯å°†åœ¨ `http://localhost:5173` å¯åŠ¨ï¼Œæ‰€æœ‰ `/api` è¯·æ±‚ä¼šè‡ªåŠ¨ä»£ç†åˆ°åç«¯ `http://localhost:3000`ã€‚

### 4. éªŒè¯æ•°æ®æµ

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`
2. æ‰“å¼€å¼€å‘è€…å·¥å…· Network é¢æ¿
3. æ‰§è¡Œä»»ä½•ç½‘ç»œæ“ä½œï¼ˆåˆ›å»ºé¡¹ç›®ã€æ·»åŠ èŠ‚ç‚¹ç­‰ï¼‰
4. è§‚å¯Ÿ API è¯·æ±‚æ˜¯å¦æˆåŠŸ
5. æŸ¥çœ‹æ•°æ®åº“ï¼š`node scripts/dbManager.js stats`

## æ•°æ®åº“æ–‡ä»¶ä½ç½®

```
backend/
â””â”€â”€ database/
    â””â”€â”€ killchain.db       # SQLite æ•°æ®åº“æ–‡ä»¶

db_backups/                # å¤‡ä»½ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ database_2026-01-05T07-30-00-000Z.sqlite
â”œâ”€â”€ database_2026-01-05T08-00-00-000Z.sqlite
â””â”€â”€ ...
```

**æ³¨æ„ï¼š** æ•°æ®åº“æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šæäº¤åˆ° Git ä»“åº“ã€‚

## ç¯å¢ƒé…ç½®

### å‰ç«¯ç¯å¢ƒå˜é‡ (.env.development)
```env
VITE_APP_BASE_API=/api
VITE_APP_TITLE=ä½œæˆ˜ç½‘ç»œç³»ç»Ÿ
```

### Vite ä»£ç†é…ç½®
```javascript
// vite.config.js
server: {
  port: 5173,          // å‰ç«¯ç«¯å£
  proxy: {
    '/api': {
      target: 'http://localhost:3000',  // åç«¯åœ°å€
      changeOrigin: true
    }
  }
}
```

### åç«¯é…ç½®
```javascript
// backend/server.js
const PORT = 3000  // åç«¯ç«¯å£
```

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆå‰ç«¯ç«¯å£æ”¹æˆ 5173ï¼Ÿ
**A:** åŸæ¥å‰ç«¯ä¹Ÿæ˜¯ 3000ï¼Œä¼šå’Œåç«¯å†²çªã€‚ç°åœ¨åç«¯ç”¨ 3000ï¼Œå‰ç«¯ç”¨ 5173ï¼ˆVite é»˜è®¤ç«¯å£ï¼‰ã€‚

### Q2: æ•°æ®å­˜åœ¨å“ªé‡Œï¼Ÿ
**A:** å­˜åœ¨ `backend/database/killchain.db` SQLite æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ç”¨ DB Browser for SQLite ç­‰å·¥å…·æŸ¥çœ‹ã€‚

### Q3: å¦‚ä½•æ¸…ç†æµ‹è¯•æ•°æ®ï¼Ÿ
**A:** ä½¿ç”¨ `node scripts/dbManager.js clear` æ¸…ç©ºæ•°æ®ï¼Œæˆ– `reset` å®Œå…¨é‡ç½®ã€‚

### Q4: æ•°æ®åº“å‡ºé”™äº†æ€ä¹ˆåŠï¼Ÿ
**A:**
1. å…ˆæŸ¥çœ‹é”™è¯¯æ—¥å¿—
2. å°è¯• `node scripts/dbManager.js restore` æ¢å¤å¤‡ä»½
3. å¦‚æœæ²¡æœ‰å¤‡ä»½ï¼Œä½¿ç”¨ `reset` é‡æ–°åˆå§‹åŒ–

### Q5: æ€ä¹ˆç¡®è®¤æ•°æ®ç¡®å®ä¿å­˜åˆ°æ•°æ®åº“äº†ï¼Ÿ
**A:**
```bash
# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
node scripts/dbManager.js stats

# æˆ–è€…åœ¨å‰ç«¯åˆ›å»ºæ•°æ®åï¼Œé‡å¯æµè§ˆå™¨ï¼Œæ•°æ®è¿˜åœ¨å°±è¯´æ˜ä¿å­˜æˆåŠŸäº†
```

## æŠ€æœ¯æ ˆ

- **å‰ç«¯ï¼š** Vue 3 + Pinia + Axios
- **åç«¯ï¼š** Express.js + Sequelize
- **æ•°æ®åº“ï¼š** SQLite 3
- **å¼€å‘å·¥å…·ï¼š** Vite + Nodemon

## ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ·»åŠ ç”¨æˆ·è®¤è¯å’Œæƒé™æ§åˆ¶
- [ ] å®ç°æ•°æ®å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- [ ] æ·»åŠ æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥
- [ ] å®Œå–„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## æ€»ç»“

è¿™æ¬¡è¿ç§»çš„æ ¸å¿ƒå°±æ˜¯ï¼š**æŠŠå‰ç«¯ store æ¨¡å—ä¸­çš„ localStorage å­˜å‚¨æ”¹æˆè°ƒç”¨åç«¯ APIï¼Œåç«¯å†ä¿å­˜åˆ°æ•°æ®åº“**ã€‚

è™½ç„¶å¬èµ·æ¥ç®€å•ï¼Œä½†å®é™…éœ€è¦ï¼š
1. åç«¯æ•°æ®åº“å»ºæ¨¡
2. åç«¯ API å¼€å‘
3. å‰ç«¯å¼‚æ­¥æ”¹é€ 
4. ç¯å¢ƒé…ç½®è°ƒæ•´
5. æµ‹è¯•å·¥å…·å‡†å¤‡

ç°åœ¨æ‰€æœ‰è¿™äº›å·¥ä½œéƒ½å·²å®Œæˆï¼Œæ‚¨å¯ä»¥å®‰å…¨åœ°è¿›è¡Œæµ‹è¯•å’Œå¼€å‘äº†ï¼
